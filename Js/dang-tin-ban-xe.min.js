$(document).ready(function () {
  // variables
  var mainColor = "#da5427#";
  var DATETIME_FORMAT = "DD/MMYYYY hh:mm:ss";
  var switchBaseConfig = {
    on_txt: "Có",
    off_txt: "Không",
    on_color: mainColor,
  };
  const provinceList = [
    {
      id: 1,
      text: "Hà Nội",
    },
    {
      id: 2,
      text: "Hải Phòng",
    },
  ];

  // form validation
  const validator = $("#form-dang-tin").validate({
    errorClass: "error-label c-main mt-2",
    rules: {
      image: {
        required: true,
        number: true,
        min: 1,
      },
      title: {
        required: true,
      },
      "description-value": {
        required: true,
        minlength: 100,
      },
      price: {
        required: true,
      },
      location: {
        required: true,
      },
    },
    messages: {
      image: {
        required: "Hình ảnh không được để trống",
        min: "Hình ảnh không được để trống",
      },
      title: {
        required: "Tiêu đề không được bỏ trống",
      },
      "description-value": {
        required: "Mô tả không được để trống",
        minlength: "Mô tả ít hơn 100 ký tự",
      },
      price: {
        required: "Giá không được để trống",
      },
      location: {
        required: "Tỉnh thành không được để trống",
      },
    },
    highlight: function (element, errorClass) {
      $(element).removeClass(errorClass);
    },
  });

  $("#form-dang-tin").steps({
    headerTag: "h4",
    bodyTag: "section",
    transitionEffect: "fade",
    titleTemplate: '<div class="title">#title#</div>',
    autoFocus: true,
    enableAllSteps: true,
    transitionEffectSpeed: 300,
    labels: {
      next: '<i class="zmdi zmdi-arrow-right"></i>',
      previous: "Trở lại",
      finish: "Đăng tin",
    },
  });
  $("#tiep-theo").click(function () {
    $("#form-dang-tin").steps("next");
  });
  $("#quay-lai").click(function () {
    $("#form-dang-tin").steps("previous");
  });

  $("#editor").tinymce({
    height: 300,
    width: "100%",
    menubar: false,
    plugins: [
      "advlist autolink lists link image charmap print preview anchor",
      "searchreplace visualblocks code fullscreen",
      "insertdatetime media table paste code help wordcount",
    ],
    toolbar:
      "undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help",
    statusbar: false,
    skin: "outside",
    setup: function (editor) {
      editor.on("init", function (e) {
        // editor.setContent(
        //   deserializeContent($("input[name=description]").val()),
        // );
      });
    },
    init_instance_callback: function (editor) {
      //   editor.on("keydown", function (e) {
      //     var value = sanitizeInputContent(editor.getContent());
      //     updatePost("description", value);
      //     descriptionEl.val(value);
      //     validator.element(descriptionEl); // re-validate description manually
      //   });
      //   editor.on("keyup", function (e) {
      //     var value = sanitizeInputContent(editor.getContent());
      //     updatePost("description", value);
      //     descriptionEl.val(value);
      //     validator.element(descriptionEl); // re-validate description manually
      //   });
      //   editor.on("blur", function (e) {
      //     var value = sanitizeInputContent(editor.getContent());
      //     updatePost("description", value);
      //     descriptionEl.val(value);
      //     validator.element(descriptionEl); // re-validate description manually
      //   });
    },
  });

  const switchSelector = $("input[type=checkbox].lcs_check");
  lc_switch(switchSelector, switchBaseConfig); // init switch
  switchSelector.on("lcs-statuschange", function (e) {
    let status = this.checked ? "checked" : "unchecked";
  });

  $("#tinh-thanh").select2({
    data: provinceList,
    placeholder: "Tỉnh/Thành phố bán xe",
  });
});
